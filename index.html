<script>
// Funci√≥n para inicializar la c√°mara autom√°ticamente
        async function initializeCamera() {
            try {
                showStatus('üîÑ Iniciando c√°mara...', 'success');
                
                stream = await navigator.mediaDevices.getUserMedia({
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    }
                });
                
                video.srcObject = stream;
                video.style.display = 'block';
                noCameraMessage.style.display = 'none';
                
                // Esperar a que el video est√© listo
                video.addEventListener('loadedmetadata', () => {
                    // Inicializar Quagga para escaneo
                    Quagga.init({
                        inputStream: {
                            name: "Live",
                            type: "LiveStream",
                            target: video,
                            constraints: {
                                width: { min: 640, ideal: 1280 },
                                height: { min: 480, ideal: 720 },
                                facingMode: "environment"
                            }
                        },
                        locator: {
                            patchSize: "medium",
                            halfSample: true
                        },
                        numOfWorkers: 2,
                        frequency: 10,
                        decoder: {
                            readers: [
                                "code_128_reader",
                                "ean_reader",
                                "ean_8_reader",
                                "code_39_reader",
                                "code_39_vin_reader",
                                "codabar_reader",
                                "upc_reader",
                                "upc_e_reader"
                            ]
                        },
                        locate: true
                    }, (err) => {
                        if (err) {
                            console.error('Error al inicializar Quagga:', err);
                            showStatus('‚ùå Error al inicializar el esc√°ner', 'error');
                            return;
                        }
                        
                        Quagga.start();
                        isScanning = true;
                        startBtn.disabled = true;
                        stopBtn.disabled = false;
                        showStatus('üì∑ Listo para escanear c√≥digos', 'success');
                    });
                });
                
                // Detectar c√≥digos de barras con control de duplicados
                Quagga.onDetected((data) => {
                    if (isScanning && !scanCooldown) {
                        const barcode = data.codeResult.code;
                        console.log('C√≥digo detectado:', barcode);
                        searchProduct(barcode);
                    }
                });
                
            } catch (error) {
                console.error('Error al acceder a la c√°mara:', error);
                showStatus('‚ùå Error al acceder a la c√°mara', 'error');
                noCameraMessage.innerHTML = `
                    <div class="no-camera-icon">üì∑</div>
                    <div>Error al acceder a la c√°mara</div>
                    <div style="font-size: 14px; margin-top: 10px;">Toca "Activar C√°mara" para intentar de nuevo</div>
                `;
                startBtn.disabled = false;
            }
        }
        </script>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/styles.css">
    <title>Verificador de Precios</title>

</head>
<body>
    <div class="app-container">
        <!-- Secci√≥n del Logo -->
        <div class="logo-section">
            <div class="logo-content">
                <span class="logo-icon">üè™</span>
                <div>SUPER MARKET</div>
                <div style="font-size: 14px; opacity: 0.9; margin-top: 5px;">Tu tienda de confianza</div>
            </div>
        </div>

        <!-- Secci√≥n de Publicidad -->
        <div class="ads-section">
            <div class="ads-content">
                <div class="ads-banner">üéØ ¬°OFERTA!</div>
                <div class="ads-text">Coca Cola 2L</div>
                <div class="ads-price">$35.99</div>
                <div style="font-size: 12px; margin-top: 5px; color: #666;">*V√°lido hasta agotar existencias</div>
            </div>
        </div>

        <!-- Secci√≥n de la C√°mara/Esc√°ner -->
        <div class="camera-section">
            <div class="camera-container">
                <video id="video" autoplay playsinline style="display: none;"></video>
                <div class="no-camera-message" id="noCameraMessage">
                    <div class="no-camera-icon">üì∑</div>
                    <div>Iniciando c√°mara...</div>
                </div>
                
                <div class="camera-overlay">
                    <div class="scanner-frame">
                        <div class="scan-line"></div>
                    </div>
                </div>
            </div>

            <!-- Controles de c√°mara -->
            <div class="camera-controls">
                <button class="control-btn" id="startBtn">üì∏ Activar C√°mara</button>
                <button class="control-btn" id="stopBtn" disabled>‚èπÔ∏è Detener</button>
            </div>
        </div>
    </div>

    <!-- Popup del producto -->
    <div class="popup-overlay" id="popupOverlay"></div>
    <div class="product-popup" id="productPopup">
        <h2 id="productName">Nombre del Producto</h2>
        <div class="price" id="productPrice">$0.00</div>
        <div class="barcode" id="productBarcode">C√≥digo: 000000000000</div>
        <div style="font-size: 12px; color: #95a5a6;">Se cerrar√° autom√°ticamente en <span id="countdown">4</span> segundos</div>
    </div>

    <div id="status" class="status" style="display: none;"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
    <script src="JS/script.js"></script>
</body>
</html>